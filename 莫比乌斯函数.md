<!--more-->
### 莫比乌斯反演 ###
莫比乌斯反演是数论数学中很重要的内容，可以用于解决很多组合数学的问题。

### 莫比乌斯函数

莫比乌斯函数，数论函数，由德国数学家和天文学家莫比乌斯提出。梅滕斯首先使用μ(n)作为莫比乌斯函数的记号。

莫比乌斯函数是指以下的函数：

![](http://i.imgur.com/2DkolzQ.png)

在这里，λ(n)是刘维尔函数

莫比乌斯函数是一个数论函数，它同时也是一个积极函数`（μ(ab) =μ(a)μ(b), a,b互质 ）`

当n不等于1时，n的所有因子的莫比乌斯函数值的和为0

![](http://i.imgur.com/UolVfF3.png)

莫比乌斯函数完整定义的通俗表达：

1、莫比乌斯函数μ(n)的定义域是N

2、μ(1)=1

3、当n存在平方因子时，μ(n)=0

4、当n是素数或奇数个不同素数之积时，μ(n)=-1

5、当n是偶数个不同素数之积时，μ(n)=1

![](http://i.imgur.com/cuTmDdJ.png)

### 莫比乌斯反演的引入

莫比乌斯反演是数论中的重要内容，在许多情况下能够简化运算。我们考虑以下和函数：

![](http://i.imgur.com/CyrxOgW.png)

`d|n`意思是d是n的因子
我们需要找到f(n)和F(n)之间的关系。从和函数定义中可以看出：

```cpp
F(1)=f(1)

F(2)=f(1)+f(2)

F(3)=f(1)+f(2)+f(3)

F(4)=f(1)+f(2)+f(4)

F(5)=f(1)+f(5)

F(6)=f(1)+f(2)+f(3)+f(6)

F(7)=f(1)+f(7)

F(8)=f(1)+f(2)+f(4)+f(8)

F(9)=f(1)+f(3)+f(9)

那么我们就可以推出：

f(1)=F(1)

f(2)=F(2)-F(1)

f(3)=F(3)-F(1)

f(4)=F(4)-F(2)

f(5)=F(5)-F(1)

f(6)=F(6)-F(3)-F(2)-F(1)

f(7)=F(7)-F(1)

f(8)=F(8)-F(4)

f(9)=F(9)-F(3)
```

从中我们可以看出，若n=p^2(p为质数)，那么，`F(p)=f(1)+f(p)，F(n)=f(1)+f(p)+f(p^2)`，所以，`f(n)=F(P^2)-F(P)`.

如果我们要函数满足：

那么通过上边推导，我们可以知道`μ(p^2)=0`所以我们猜测：

![](http://i.imgur.com/oj6sUNp.png)

### 莫比乌斯反演定理

设f(n)和g(n)是定义在正整数集合上的两个函数。定义如下：

![](http://i.imgur.com/JNsAHyg.png)

![](http://i.imgur.com/IMS7Ao3.png)


则![](http://i.imgur.com/qJLsmma.png)

### 莫比乌斯函数μ(d)定义

若d=1，那么μ(d)=1

若d=p1p2……pk (k为不同质数，且次数都为一)，μ(d)=(-1)^k

其余 μ(d)=0

### 莫比乌斯反演的性质

- 性质一 （莫比乌斯反演公式）：

![](http://i.imgur.com/redJNot.png)

- 性质二：μ(n)为积极函数

- 性质三：设f是算术函数，它的和函数
![](http://i.imgur.com/StHMGoo.png) 

是积极函数，那么f也是积极函数